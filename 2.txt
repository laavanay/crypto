Step 1: Network Setup:
Check the IP address of source VM Kali Linux and Target VM Ubuntu by using
ifconfig command in terminal.
Step 2: Configure Ubuntu as firewall target
a. Enable UFW
sudo ufw enable
b. Add Rules
sudo ufw deny 80/tcp # block web traﬃc
sudo ufw allow 22/tcp # allow SSH
For icmp packets to block we can add following block rules:
sudo iptables -I INPUT 1 -p icmp --icmp-type echo-request -j DROP
Step 4: Scapy Script in Kali Linux
vi packet_lab.py
import socket
import time

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)

for i in range(5):
    msg = f"DEVICE_DISCOVERY_{i}".encode()
    sock.sendto(msg, ("255.255.255.255", 4000))
    print(f"[Sent] {msg}")
    time.sleep(1)

Step 5: Start Wireshark in Kali Linux
Start wireshark and chose interface etho
Step 6: Run the Scapy Script
sudo python3 packet_lab.py
Step 7: Observe the output:
Now output can be checked in 2 ways:
1st way:open Wireshark once packets are captured and check with
the below filters:
➔ icmp
➔ tcp.flags.syn==1
we will see TCP [SYN] Kali-> Unix(port 80).. then no RST, no
Syn/Ack.
➔ tcp.port==22
In wireshark we will see
TCP[SYN] kali -> Ubuntu
Tcp[Syn, ACk] Ubuntu-> kali
TCP [ACK] Kali-> Ubuntu